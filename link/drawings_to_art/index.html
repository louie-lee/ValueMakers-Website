<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawings to Art - Download</title>
    <script src="https://cdn.amplitude.com/libs/analytics-browser-2.11.1-min.js.gz"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: #f5f5f5;
        }
        .loading {
            text-align: center;
            color: #666;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #ddd;
            border-top-color: #333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading">
        <div class="loading-spinner"></div>
        <p>앱 스토어로 이동 중...</p>
    </div>

    <script>
        (function() {
            // App store URLs
            var IOS_URL = 'https://apps.apple.com/app/id6755988573';
            var ANDROID_URL = 'https://play.google.com/store/apps/details?id=kids.drawing.to.art';

            // Parse URL parameters
            function getUrlParams() {
                var params = {};
                var search = window.location.search.substring(1);
                if (search) {
                    search.split('&').forEach(function(pair) {
                        var parts = pair.split('=');
                        params[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1] || '');
                    });
                }
                return params;
            }

            // Detect platform
            function getPlatform() {
                var ua = navigator.userAgent || navigator.vendor || window.opera;
                if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) {
                    return 'ios';
                }
                if (/android/i.test(ua)) {
                    return 'android';
                }
                return 'unknown';
            }

            // Get redirect URL based on platform
            function getRedirectUrl(platform) {
                if (platform === 'ios') {
                    return IOS_URL;
                }
                if (platform === 'android') {
                    return ANDROID_URL;
                }
                return IOS_URL;
            }

            // Initialize and track
            var platform = getPlatform();
            var urlParams = getUrlParams();
            var redirectUrl = getRedirectUrl(platform);

            // Initialize Amplitude
            amplitude.init('61d99f175784bcde8f518913f48dead6', {
                defaultTracking: false
            });

            // Track the link click event
            amplitude.track('Dynamic Link Clicked', {
                // Link info
                app_name: 'Drawings to Art',

                // Platform info
                platform: platform,
                user_agent: navigator.userAgent,

                // UTM parameters from URL
                utm_source: urlParams.utm_source || 'direct',
                utm_medium: urlParams.utm_medium || '',
                utm_campaign: urlParams.utm_campaign || 'drawings_to_art',
                utm_content: urlParams.utm_content || '',
                utm_term: urlParams.utm_term || '',

                // Redirect destination
                redirect_url: redirectUrl
            });

            // Redirect after a brief delay to ensure event is sent
            setTimeout(function() {
                window.location.href = redirectUrl;
            }, 300);
        })();
    </script>
</body>
</html>
